
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://res.cloudinary.com/dcmnwc3ux/image/upload/v1493918347/%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7_2017-05-05_%E4%B8%8A%E5%8D%881.09.00_fnw5k9.png">

    <title>粵語拼音翻譯器: From Cantonese to IPA</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

    <!-- Custom styles for this template -->
    <link href="https://v4-alpha.getbootstrap.com/examples/sticky-footer/sticky-footer.css" rel="stylesheet">
  </head>

  <body>

    <!-- Begin page content -->
    <div class="container">
      <div class="mt-1">
        <h1>粵語拼音翻譯器</h1>
        <h4>Cantonese IPA Translator</h4>
        <hr>
      </div>

      <div class="row">
        <div class="col-md-6">

          <div class="form-group">
            <label>中文字 (Chinese):</label>
            <textarea class="form-control" rows="10" id="cWords_tBox" onkeyup="cWords_tBox_change()" placeholder="Input some Chinese words. ">國際音標，早期又稱萬國音標，是一套用來標音的系統，以拉丁字母為基礎，由國際語音學學會設計來作為口語聲音的標準化標示方法。
            </textarea>
          </div>

        </div>
        <div class="col-md-6">



          <div class="form-group">
            <label >拼音 (PINYIN):
            </label>
            <textarea class="form-control" rows="10" id="IPA_tBox" disabled="true"></textarea>
          </div>


        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <label>Format:  </label>
          <div class="form-check form-check-inline">
            <label class="form-check-label">
              <input class="form-check-input" type="radio" name="inlineRadioOptions" id="IPA_num" value="option2" checked="checked" onchange="cWords_tBox_change()"> /nei13/
            </label>
          </div>
          <div class="form-check form-check-inline">
            <label class="form-check-label">
              <input class="form-check-input" type="radio" name="inlineRadioOptions" id="IPA_org" value="option1" onchange="cWords_tBox_change()"> /nei˩˧/
            </label>
          </div>
          <div class="form-check form-check-inline">
            <label class="form-check-label">
              <input class="form-check-input" type="radio" name="inlineRadioOptions" id="Jyutping" value="option3" onchange="cWords_tBox_change()"> /nei5/
            </label>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-check ">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" checked="checked" onchange="cWords_tBox_change()" id="wf_c_words">
              With Chinese Words
            </label>
          </div>
          <div class="form-check ">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" checked="checked" onchange="cWords_tBox_change()" id="allow_words_search">
              Allow Words Search
            </label>
          </div>
        </div>
      </div>


      <br>

      <h4>Description</h4>
      <hr>
      <p>This project is use to translate conatonese to IPA in difference format.</p>
      <br>


      <h4>Built With </h4>
      <hr>
      <p>  - <a href="./ipa_list.html">IPA database</a> : <a href="https://open-dict-data.github.io/ipa-lookup/yue/"> 粵語國際音標查詢</a>  </p>
      <p> - Boostrap: <a href="https://getbootstrap.com/"> LINK </a> </p>
    
      <br>

      <h4>Useful Links </h4>
      <hr>
      <p> - 粵語拼音對照表: <a href="https://zh.m.wikipedia.org/wiki/%E7%B2%B5%E8%AA%9E%E6%8B%BC%E9%9F%B3%E5%B0%8D%E7%85%A7%E8%A1%A8"> WIKI</a> </p>
      
      <p> - 粵語審音配詞字庫: <a href="http://humanum.arts.cuhk.edu.hk/Lexis/lexi-can/"> CU</a> </p>
      
      <p> - International Phonetic Alphabet: <a href="https://en.wikipedia.org/wiki/International_Phonetic_Alphabet"> WIKI </a> </p>
      
      
      <br>
    </div>


    
    <footer class="footer" >
      <div class="container">
        <span class="text-muted">Power By: LOTUS FA, <a href="https://lotusfa.com/">lotusfa.com</a></span>
      </div>
    </footer>

    <div id="demo"></div>
    <script type="text/javascript">

      let IPA_result = "";

      function cWords_tBox_change () {

        let c_w = get_IPA_tBox ();
        set_IPA_tBox ("loading....");
        get_IPA_DB ((obj)=>{

          let str = "";

          for (var i = 0; i < c_w.length ; i++) {
            if(typeof obj[c_w[i]] != "undefined"){

              if (document.getElementById("allow_words_search").checked) {

                let s_words = [];
                s_words[0] = c_w[i];
                s_words[1] = s_words[0] + c_w[i+1];
                s_words[2] = s_words[1] + c_w[i+2];
                s_words[3] = s_words[2] + c_w[i+3];
                s_words[4] = s_words[3] + c_w[i+4];
                s_words[5] = s_words[4] + c_w[i+5];

                let words_index = 0;
                if (typeof obj[s_words[5]] != "undefined") { words_index = 5; }
                else if (typeof obj[s_words[4]] != "undefined") { words_index = 4;}
                else if (typeof obj[s_words[3]] != "undefined") { words_index = 3;}
                else if (typeof obj[s_words[2]] != "undefined") { words_index = 2;}
                else if (typeof obj[s_words[1]] != "undefined") { words_index = 1;}
                else if (typeof obj[s_words[0]] != "undefined") { words_index = 0;}

                search_words = s_words[words_index];
                if (document.getElementById("wf_c_words").checked) {
                  str += "(" + search_words + " /" + obj[search_words] + "/ )";
                }else  str += "/" + obj[search_words] + "/ ";
                i += words_index;

              }else{
                if (document.getElementById("wf_c_words").checked) {
                  str += c_w[i] + "/" + obj[c_w[i]] + "/ ";
                }else  str = str + "/" + obj[c_w[i]] + "/ ";
              }
            }else str += c_w[i] + " ";
          }

          set_IPA_tBox (str);

        });
      }

      function get_IPA_DB (s) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                return s(myObj);
            }
        };

        xmlhttp.open("GET", "./ipa_data.txt", true);
        xmlhttp.send();
      }

      function get_IPA_tBox () {
        return document.getElementById("cWords_tBox").value
      }

      function set_IPA_tBox (v = IPA_result) {
        let tBox_str = format_main(v);
        document.getElementById("IPA_tBox").value = tBox_str;
      }

      function format_main(t_str){
        let f_str = t_str;

        if (document.getElementById("IPA_num").checked) f_str = format_IPA_num (t_str);
        else if (document.getElementById("IPA_org").checked) f_str = format_IPA_org (t_str);
        else if (document.getElementById("Jyutping").checked) f_str = format_Jyutping (t_str);
        
        return f_str;
      }

      function format_IPA_org (x){
        return x;
      }

      function format_IPA_num (x) {
          x = x.replace(/˥/g, "5");
          x = x.replace(/˧/g, "3");
          x = x.replace(/˨/g, "2");
          x = x.replace(/˩/g, "1");
          x = x.replace(/:/g, "");
          return x;
      }

      function format_Jyutping (x) {
          x = x.replace(/˥˧/g, "1");
          x = x.replace(/˥˥/g, "1");
          x = x.replace(/˧˥/g, "2");
          x = x.replace(/˧˥/g, "2");
          x = x.replace(/˧˧/g, "3");
          x = x.replace(/˨˩/g, "4");
          x = x.replace(/˩˩/g, "4");
          x = x.replace(/˩˧/g, "5");
          x = x.replace(/˨˧/g, "5");
          x = x.replace(/˨˨/g, "6");
          x = x.replace(/˥/g, "7");
          x = x.replace(/˧/g, "8");
          x = x.replace(/˨/g, "9");
          x = x.replace(/:/g, "");
          return x;
      }

      cWords_tBox_change ();
    </script>

        <!--Google Analysis -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-80492067-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
